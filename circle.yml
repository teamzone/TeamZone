machine:
  node:
    version: 4.3.2
    
  environment:
    REDISTOGO_URL: redis://redistogo:cdc1c4f5a4f9ea8429387f63eadbccdf@hoki.redistogo.com:10765/
    UITEST_BROWSER: Chrome
    UITEST_BROWSER_VERSION: 50
    UITEST_OS: Windows
    UITEST_OS_VERSION: 10
    UITEST_RESOLUTION: 1680x1050
    UITEST_SERVER: http://hub.browserstack.com/wd/hub
    UITEST_LOCAL_TEST: false
    UITEST_DEBUG: true    

general:
  artifacts:
    - "coverage.lcov" 
    
test:
  pre:
    - npm install -g grunt-cli
    
  override:
    - grunt cibuild 
# Deploy to the heroku site so some ui-tests can run, not all just a sanity check.  They can be slow and another build will run the full suite
    - git push heroku $CIRCLE_BRANCH:master

deployment:
  dev:
    branch: master
    heroku:
      appname: circleci-cibuild
  uit:
    branch: UIT
    heroku:
      appname: circleci-cibuild
  staging:
      branch: staging
      heroku:
        appname: circleci-cibuild-staging      